{"version":3,"file":"vue.js","sources":["../src/observer/index.js","../src/initState.js","../src/init.js","../src/index.js"],"sourcesContent":["export function observer(data) {\r\n    console.log(data)\r\n    // TODO: (1) 对象的处理 vue2\r\n    // 判断\r\n    if( typeof data != 'object' || data === null){\r\n        return data\r\n    }\r\n    // 通过一个类进行劫持\r\n    return new Observer(data)\r\n\r\n}\r\n\r\nclass Observer{\r\n    constructor(value) {\r\n        this.walk(value)  // 遍历\r\n    }\r\n    walk(data) {  // { msg: 'hello' }\r\n        // 原始写法\r\n        // let keys = Object.keys(data)\r\n        // for(let i=0;i<keys.length;i++) {\r\n        //     // 对我们的每个属性进行劫持\r\n        //     let key = keys[i]\r\n        //     let value = data[key]\r\n        //     definedReactive(data,key,value)\r\n        // }\r\n\r\n        // Es6写法\r\n        for(let [key,value] of Object.entries(data)){\r\n            definedReactive(data,key,value)\r\n        }\r\n    }\r\n}\r\n// 对 对象中的属性进行劫持\r\nfunction definedReactive(data,key,value) {\r\n    observer(value) // 深度代理\r\n    Object.defineProperty(data,key,{\r\n        // 获取的时候触发\r\n        get() {\r\n            console.log('获取的时候触发')\r\n            return value  // 返回值\r\n        },\r\n        set(newValue) {\r\n            console.log('设置的时候触发')\r\n            if(newValue === value) return value\r\n            observer(newValue)  // 如果用户设置的值是对象\r\n            value = newValue    \r\n        }\r\n    })\r\n}\r\n\r\n\r\n// vue2 object.defineProperty 缺点：对象中的一个属性  {a:1,b:2}\r\n\r\n// {a:{},list:[]}\r\n\r\n// 总结：1) 对象\r\n// 1、vue2 object.defineProperty 有缺点，只能对对象中的一个属性进行劫持 \r\n// 2、遍历{a:1,b:2,obj:{}}\r\n// 3、递归 get    set","import { observer } from \"./observer/index\"\r\n\r\nexport function initState(vm) {\r\n    let opts = vm.$options\r\n    // console.log(opts)\r\n    // 判断\r\n    if(opts.props){\r\n        initProps()\r\n    }\r\n    if(opts.data){\r\n        initData(vm)\r\n    }\r\n    if(opts.watch){\r\n        initWatch()\r\n    }\r\n    if(opts.computed){\r\n        initComputed()\r\n    }\r\n    if(opts.methods){\r\n        initMethods()\r\n    }\r\n\r\n    // 计算属性\r\n    function initComputed() {}\r\n    // 方法属性\r\n    function initMethods() {}\r\n    // Props属性\r\n    function initProps() {}\r\n    // watch方法\r\n    function initWatch() {}\r\n\r\n\r\n    // data属性  TODO: 对data初始化 \r\n    function initData(vm) {\r\n        // console.log('data初始化',vm) // 1. data可能是对象 2.对象可能是函数\r\n        let data = vm.$options.data\r\n        vm._data = typeof data === \"function\" ? data.call(vm):data // 注意 this指向问题\r\n        data = vm._data  \r\n        // 数据进行劫持\r\n        observer(data)\r\n    }\r\n\r\n    // data{}  (1) 对象 (2) 数组 {a:{b:1},list:[1,2,3],arr:[{}]}\r\n\r\n\r\n\r\n    \r\n}","import { initState } from \"./initState\"\r\n\r\n// 为 Vue.js 添加初始化 mixin\r\nexport function initMixin(Vue) {\r\n    // 将 _init 方法添加到 Vue.prototype 中\r\n    Vue.prototype._init = function(options) {\r\n        // console.log(options)\r\n\r\n        // 将当前实例赋值给 vm\r\n        let vm = this  \r\n        // 将传入的 options 对象赋值给实例的 $options 属性\r\n        vm.$options = options\r\n        // 初始化实例状态\r\n        initState(vm)\r\n    }\r\n}\r\n\r\n","import {initMixin} from './init'\r\n\r\nfunction Vue(options) {\r\n    // 初始化\r\n    this._init(options)\r\n\r\n}\r\n\r\ninitMixin(Vue)\r\n\r\nexport default Vue"],"names":["observer","data","console","log","_typeof","Observer","value","_classCallCheck","walk","_createClass","key","_i","_Object$entries","Object","entries","length","_Object$entries$_i","_slicedToArray","definedReactive","defineProperty","get","set","newValue","initState","vm","opts","$options","props","initData","watch","computed","methods","_data","call","initMixin","Vue","prototype","_init","options"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;EAAO,SAASA,QAAQA,CAACC,IAAI,EAAE;EAC3BC,EAAAA,OAAO,CAACC,GAAG,CAACF,IAAI,CAAC,CAAA;EACjB;EACA;IACA,IAAIG,OAAA,CAAOH,IAAI,CAAA,IAAI,QAAQ,IAAIA,IAAI,KAAK,IAAI,EAAC;EACzC,IAAA,OAAOA,IAAI,CAAA;EACf,GAAA;EACA;EACA,EAAA,OAAO,IAAII,QAAQ,CAACJ,IAAI,CAAC,CAAA;EAE7B,CAAA;EAAC,IAEKI,QAAQ,gBAAA,YAAA;IACV,SAAAA,QAAAA,CAAYC,KAAK,EAAE;EAAAC,IAAAA,eAAA,OAAAF,QAAA,CAAA,CAAA;EACf,IAAA,IAAI,CAACG,IAAI,CAACF,KAAK,CAAC,CAAE;EACtB,GAAA;EAACG,EAAAA,YAAA,CAAAJ,QAAA,EAAA,CAAA;MAAAK,GAAA,EAAA,MAAA;EAAAJ,IAAAA,KAAA,EACD,SAAAE,IAAKP,CAAAA,IAAI,EAAE;EAAG;EACV;EACA;EACA;EACA;EACA;EACA;EACA;EACA;;EAEA;EACA,MAAA,KAAA,IAAAU,EAAA,GAAAC,CAAAA,EAAAA,eAAA,GAAuBC,MAAM,CAACC,OAAO,CAACb,IAAI,CAAC,EAAAU,EAAA,GAAAC,eAAA,CAAAG,MAAA,EAAAJ,EAAA,EAAC,EAAA;EAAxC,QAAA,IAAAK,kBAAA,GAAAC,cAAA,CAAAL,eAAA,CAAAD,EAAA,CAAA,EAAA,CAAA,CAAA;EAAKD,UAAAA,GAAG,GAAAM,kBAAA,CAAA,CAAA,CAAA;EAACV,UAAAA,KAAK,GAAAU,kBAAA,CAAA,CAAA,CAAA,CAAA;EACdE,QAAAA,eAAe,CAACjB,IAAI,EAACS,GAAG,EAACJ,KAAK,CAAC,CAAA;EACnC,OAAA;EACJ,KAAA;EAAC,GAAA,CAAA,CAAA,CAAA;EAAA,EAAA,OAAAD,QAAA,CAAA;EAAA,CAEL,EAAA,CAAA;EACA,SAASa,eAAeA,CAACjB,IAAI,EAACS,GAAG,EAACJ,KAAK,EAAE;IACrCN,QAAQ,CAACM,KAAK,CAAC,CAAC;EAChBO,EAAAA,MAAM,CAACM,cAAc,CAAClB,IAAI,EAACS,GAAG,EAAC;EAC3B;MACAU,GAAG,EAAA,SAAAA,MAAG;EACFlB,MAAAA,OAAO,CAACC,GAAG,CAAC,SAAS,CAAC,CAAA;EACtB,MAAA,OAAOG,KAAK,CAAE;OACjB;MACDe,GAAG,EAAA,SAAAA,GAACC,CAAAA,QAAQ,EAAE;EACVpB,MAAAA,OAAO,CAACC,GAAG,CAAC,SAAS,CAAC,CAAA;EACtB,MAAA,IAAGmB,QAAQ,KAAKhB,KAAK,EAAE,OAAOA,KAAK,CAAA;QACnCN,QAAQ,CAACsB,QAAQ,CAAC,CAAE;EACpBhB,MAAAA,KAAK,GAAGgB,QAAQ,CAAA;EACpB,KAAA;EACJ,GAAC,CAAC,CAAA;EACN,CAAA;;EAGA;;EAEA;;EAEA;EACA;EACA;EACA;;ECxDO,SAASC,SAASA,CAACC,EAAE,EAAE;EAC1B,EAAA,IAAIC,IAAI,GAAGD,EAAE,CAACE,QAAQ,CAAA;EACtB;EACA;IACA,IAAGD,IAAI,CAACE,KAAK,EAAC,CAEd;IACA,IAAGF,IAAI,CAACxB,IAAI,EAAC;MACT2B,QAAQ,CAACJ,EAAE,CAAC,CAAA;EAChB,GAAA;IACA,IAAGC,IAAI,CAACI,KAAK,EAAC,CAEd;IACA,IAAGJ,IAAI,CAACK,QAAQ,EAAC,CAEjB;IACA,IAAGL,IAAI,CAACM,OAAO,EAAC,CAEhB;;EAYA;IACA,SAASH,QAAQA,CAACJ,EAAE,EAAE;EAClB;EACA,IAAA,IAAIvB,IAAI,GAAGuB,EAAE,CAACE,QAAQ,CAACzB,IAAI,CAAA;EAC3BuB,IAAAA,EAAE,CAACQ,KAAK,GAAG,OAAO/B,IAAI,KAAK,UAAU,GAAGA,IAAI,CAACgC,IAAI,CAACT,EAAE,CAAC,GAACvB,IAAI,CAAC;MAC3DA,IAAI,GAAGuB,EAAE,CAACQ,KAAK,CAAA;EACf;MACAhC,QAAQ,CAACC,IAAI,CAAC,CAAA;EAClB,GAAA;;EAEA;EAKJ;;EC7CA;EACO,SAASiC,SAASA,CAACC,GAAG,EAAE;EAC3B;EACAA,EAAAA,GAAG,CAACC,SAAS,CAACC,KAAK,GAAG,UAASC,OAAO,EAAE;EACpC;;EAEA;MACA,IAAId,EAAE,GAAG,IAAI,CAAA;EACb;MACAA,EAAE,CAACE,QAAQ,GAAGY,OAAO,CAAA;EACrB;MACAf,SAAS,CAACC,EAAE,CAAC,CAAA;KAChB,CAAA;EACL;;ECbA,SAASW,GAAGA,CAACG,OAAO,EAAE;EAClB;EACA,EAAA,IAAI,CAACD,KAAK,CAACC,OAAO,CAAC,CAAA;EAEvB,CAAA;EAEAJ,SAAS,CAACC,GAAG,CAAC;;;;;;;;"}